<%- include('partials/header') %>

<div class="container mt-4">
    <h2><i class="bi bi-gear"></i> Manual Generations Log</h2>
    
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <span><i class="bi bi-list"></i> Recent Manual Generations</span>
            <span class="badge bg-secondary"><%= generations.length %> records</span>
        </div>
        <div class="card-body p-0">
            <% if (generations.length > 0) { %>
                <table class="table table-striped table-hover mb-0">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Staff</th>
                            <th>Platform</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% generations.forEach(function(gen) { 
                            let details = {};
                            try { details = JSON.parse(gen.details || '{}'); } catch(e) {}
                        %>
                        <tr>
                            <td><%= new Date(gen.created_at).toLocaleString() %></td>
                            <td><%= gen.staff_member || 'Unknown' %></td>
                            <td>
                                <% if (gen.platform === 'steam') { %>
                                    <span class="badge bg-primary">Steam</span>
                                <% } else if (gen.platform === 'ea') { %>
                                    <span class="badge bg-warning">EA</span>
                                <% } else if (gen.platform === 'ubisoft') { %>
                                    <span class="badge bg-info">Ubisoft</span>
                                <% } else { %>
                                    <span class="badge bg-secondary"><%= gen.platform || 'Unknown' %></span>
                                <% } %>
                            </td>
                            <td>
                                <% if (details.userName) { %>
                                    <strong>User:</strong> <%= details.userName %><br>
                                <% } %>
                                <% if (details.gameName) { %>
                                    <strong>Game:</strong> <%= details.gameName %>
                                <% } %>
                            </td>
                        </tr>
                        <% }); %>
                    </tbody>
                </table>
            <% } else { %>
                <div class="p-4 text-center text-muted">
                    <i class="bi bi-inbox fs-1"></i>
                    <p class="mt-2">No manual generations recorded in the last 30 days</p>
                </div>
            <% } %>
        </div>
    </div>
</div>

<%- include('partials/footer') %>
