<%- include('../partials/header') %>

<div class="page-header">
    <h1 class="page-title">
        <span class="icon">ğŸ“œ</span>
        Steam Transcripts
    </h1>
</div>

<div class="card" style="margin-bottom: 1rem;">
    <form method="GET" action="/dashboard/steam/transcripts" style="display: flex; gap: 1rem; align-items: flex-end; flex-wrap: wrap;">
        <div class="form-group" style="flex: 1; min-width: 200px; margin: 0;">
            <label class="form-label">Search by Username</label>
            <input type="text" name="search" class="form-control" placeholder="Enter username..." value="<%= typeof search !== 'undefined' ? search : '' %>">
        </div>
        <button type="submit" class="btn btn-primary">ğŸ” Search</button>
        <% if (typeof search !== 'undefined' && search) { %>
        <a href="/dashboard/steam/transcripts" class="btn btn-secondary">Clear</a>
        <% } %>
    </form>
</div>

<div class="card">
    <% if (transcripts && transcripts.length > 0) { %>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Ticket ID</th>
                    <th>User</th>
                    <th>Game</th>
                    <th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <% transcripts.forEach(t => { %>
                <tr>
                    <td class="font-mono"><%= t.ticket_id %></td>
                    <td><%= t.username || t.user_id || '-' %></td>
                    <td><%= t.game_name || '-' %></td>
                    <td class="text-muted font-mono"><%= formatDate(t.created_at) %></td>
                    <td>
                        <a href="/dashboard/transcripts/<%= t.ticket_id %>" class="btn btn-secondary btn-sm">ğŸ‘ View</a>
                    </td>
                </tr>
                <% }); %>
            </tbody>
        </table>
    </div>
    <% } else { %>
    <div class="empty-state">
        <div class="icon">ğŸ“œ</div>
        <p>No transcripts found<%= typeof search !== 'undefined' && search ? ' for "' + search + '"' : '' %>.</p>
    </div>
    <% } %>
</div>

<%- include('../partials/footer') %>
